```{r}
library(data.table)
library(ggplot2)
```
```{r}
# Define the hill function
hill <- function(x, K, S) {
  return(1/(1 + (K/x)**S))
}
```

```{r}
x <- seq(0, 9)
y <- hill(x, 0.6, 1)
plot(x, y, type = "l")
```

```{r}
plot(x = seq(0, 10, 0.01), y = dgamma(seq(0, 10, 0.01), 2, 1), type="l")
```

```{r}
n <- 1e3
S <- rgamma(n, 2, 1)
K <- rgamma(n, 2, 1)
```

```{r}
Y <- matrix(nrow = n, ncol = length(x))
for (i in 1:n) {
  Y[i,] <- hill(x, K[i], S[i])
}

Y_quantile <- apply(Y, MARGIN = 2, function(x) quantile(x, probs = c(.025, .25, .5, .75, .975)))
Y_quantile <- t(Y_quantile)
colnames(Y_quantile) <- c("CL", "Q25", "Q50", "Q75", "CU")

df_Y <- as.data.frame(Y_quantile)
df_Y$x <- x

ggplot(df_Y, aes(x, Q50)) +
  geom_line() + 
  geom_ribbon(aes(ymin = Q25, ymax = Q75), alpha = 0.5) +
  geom_ribbon(aes(ymin = CL, ymax = CU), alpha = 0.1) +
  theme_bw()
```


